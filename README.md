# myfirst-kube-app
My very first application on Kubernetes!!! Above are the definition files for the services and deployments as well as StorageClass and PersistentVolumeClaim files. I used version 1.28.4 of kops to manage my cluster. I created the cluster to span 3 availability zones in us-east-1 with 3 worker nodes. 

<img width="1675" alt="Screenshot 2024-02-06 at 8 49 49â€¯PM" src="https://github.com/andreapeterson/myfirst-kube-app/assets/134665743/988412df-3ef6-4a2a-9545-8255f331b09b">


For the containers on the deployments of the database and app, I used images that I created in my [last project](https://github.com/andreapeterson/docker_milowilo) that are stored in [Docker Hub](https://hub.docker.com/). Through Imran Teli's course, I started with this multi-tier architecture on VM, then to [AWS Cloud](https://github.com/andreapeterson/AWS-MultiTier-Architecture), eventually [reconstructing it](https://github.com/andreapeterson/AWS-Webapp-Beanstalk) in AWS Cloud to include more PaaS and SaaS services, [containerized it](https://github.com/andreapeterson/docker_milowilo) and ran it on docker containers, and finally I am here deploying it with Kubernetes- and all I can say is I get the hype with Kubernetes.

However, as the saying goes 'with great power comes great responsibility', the Kubernetes documentation is hefty but important. When beginning Kubernetes, I was researching online and came across [Claire Lee's](https://medium.com/@yuminlee2) Kubernetes blogs that she wrote while studying for her CKA exam. They are written beautifully with a great analogy to a restaurant and the graphics are phenomenal. I wrote notes with her notes alongside the documentation, which really helped me grab a great grasp on Kubernetes. It was important to me to first understand before doing.

After grabbing a great grasp on Kubernetes, I dove right into the outline for project starting with the definition files. One goal of the project was to attach an EBS volume to the database. I realized that the [awsElasticBlockStore Volume](https://kubernetes.io/docs/concepts/storage/volumes/) is no longer supported and it pointed in the direction of an [AWS EBS third party](https://github.com/kubernetes-sigs/aws-ebs-csi-driver) storage driver instead. This information commenced my chase down a rabbit hole of learning all about CSI drivers, PVC's, and PV'S. Considering how these simplify the management of storage resources and decrease manual intervention, I was really shocked by the end results. I had planned to manually create an EBS volume, attach it directly in the pod deployment file, and label the nodes and make sure the pod is placed in the node with the correct zone label. Now, I sit back and relax and let the EBS CSI driver do its thing!

My most notable problem that really sent me through a loop was when the EBS volume was created, but my db pod would not complete. I checked all the logs of the pods, deployments, services, volumes, restarted everything and realized after a ~really~ long time I was looking in the wrong place and that the problem laid with the EBS CSI's pods. 2 of the pods for the CSI had node affinities for the control plane, but the control plane had a taint to not allow scheduling. Once I removed the taint, the CSI pods were scheduled and all ready and finally the db pod was able to complete and everything ran smoothly. I utilized Lens to get to the bottom of this problem and really love the visualizations and GUI they provide. 
